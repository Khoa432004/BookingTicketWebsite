(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[305],{3674:(e,t,s)=>{"use strict";s.d(t,{MainLayout:()=>$});var a=s(5155),n=s(6874),r=s.n(n),l=s(5695),i=s(2713),d=s(1432),c=s(4861),o=s(7580),h=s(3332),m=s(7395),x=s(3861),u=s(2355),f=s(3052),p=s(3999),g=s(7168),j=s(6053);let y=[{title:"Dashboard",href:"/dashboard",icon:i.A},{title:"Quản l\xfd v\xe9",href:"/tickets",icon:d.A},{title:"Danh s\xe1ch hủy v\xe9",href:"/canceled-tickets",icon:c.A},{title:"Quản l\xfd kh\xe1ch h\xe0ng",href:"/customers",icon:o.A},{title:"Quản l\xfd khuyến m\xe3i",href:"/promotions",icon:h.A},{title:"Hỗ trợ kh\xe1ch h\xe0ng",href:"/support",icon:m.A},{title:"Th\xf4ng b\xe1o",href:"/notifications",icon:x.A}];function N(){let e=(0,l.usePathname)(),{isOpen:t,toggle:s}=(0,j.c)();return(0,a.jsxs)("aside",{className:(0,p.cn)("fixed left-0 top-0 z-40 h-screen bg-white dark:bg-gray-800 border-r border-gray-200 dark:border-gray-700 transition-all duration-300",t?"w-64":"w-20"),children:[(0,a.jsxs)("div",{className:"flex h-16 items-center justify-between px-4 border-b border-gray-200 dark:border-gray-700",children:[(0,a.jsxs)(r(),{href:"/dashboard",className:(0,p.cn)("flex items-center gap-2 font-semibold text-xl transition-opacity",t?"opacity-100":"opacity-0 md:hidden"),children:[(0,a.jsx)(d.A,{className:"h-6 w-6 text-primary"}),(0,a.jsx)("span",{className:"text-gray-900 dark:text-gray-100",children:"BusTicket"})]}),(0,a.jsx)(g.$,{variant:"ghost",size:"icon",onClick:s,className:"hidden md:flex",children:t?(0,a.jsx)(u.A,{}):(0,a.jsx)(f.A,{})})]}),(0,a.jsx)("div",{className:"py-4",children:(0,a.jsx)("nav",{className:"space-y-1 px-2",children:y.map(s=>(0,a.jsxs)(r(),{href:s.href,className:(0,p.cn)("flex items-center px-4 py-3 text-sm font-medium rounded-md transition-colors",e===s.href?"bg-primary/10 text-primary":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700",!t&&"justify-center"),children:[(0,a.jsx)(s.icon,{className:(0,p.cn)("h-5 w-5",!t&&"mx-auto")}),t&&(0,a.jsx)("span",{className:"ml-3",children:s.title})]},s.href))})})]})}var v=s(2115),b=s(4783),w=s(4869),k=s(1007),C=s(7133),A=s(4416),_=s(5139),z=s(2714),S=s(5784),R=s(9840),D=s(3376),E=s(7257);let L=(e,t)=>e.length<=t?e:e.substring(0,t)+"...";function P(e){let{onClose:t}=e,[s,n]=(0,v.useState)(!1),[r,l]=(0,v.useState)("all"),[i,d]=(0,v.useState)(null),[c,o]=(0,v.useState)([]),[h,m]=(0,v.useState)(!0),[x,u]=(0,v.useState)(null);(0,v.useEffect)(()=>{(async()=>{try{m(!0);let e=await D.A.get("".concat((0,E.$_)(),"/notifications"),{withCredentials:!0});if(!Array.isArray(e.data))throw Error("Dữ liệu trả về từ API kh\xf4ng phải l\xe0 mảng");let t=e.data.map(e=>{let t=new Date(e.createdAt);return{id:e.id,title:e.title,content:e.content,time:t.toLocaleString("vi-VN",{hour:"2-digit",minute:"2-digit",day:"2-digit",month:"2-digit",year:"numeric"}),read:e.read||!1,fullContent:e.content,target:e.target.toLowerCase(),createdAt:t}});o(t)}catch(t){var e;"ERR_NETWORK"===t.code?u("Kh\xf4ng thể kết nối đến m\xe1y chủ. Vui l\xf2ng kiểm tra xem backend c\xf3 đang chạy kh\xf4ng."):(null===(e=t.response)||void 0===e?void 0:e.status)===401?u("Phi\xean đăng nhập đ\xe3 hết hạn. Vui l\xf2ng đăng nhập lại."):u("Kh\xf4ng thể tải th\xf4ng b\xe1o. Vui l\xf2ng thử lại sau."),console.error("Error fetching notifications:",t)}finally{m(!1)}})()},[]);let f=c.filter(e=>{let t="staff"===e.target||"all"===e.target,a=!s||!e.read,n=new Date,l=!0;if("all"!==r){let t=e.createdAt;if("today"===r)l=t>=new Date(n.getFullYear(),n.getMonth(),n.getDate());else if("week"===r){let e=new Date(n);e.setDate(n.getDate()-7),l=t>=e}else"month"===r&&(l=t>=new Date(n.getFullYear(),n.getMonth(),1))}return t&&a&&l}),j=async e=>{d(e);try{await D.A.put("".concat((0,E.$_)(),"/notifications/").concat(e.id,"/read"),{},{withCredentials:!0}),o(t=>t.map(t=>t.id===e.id?{...t,read:!0}:t))}catch(e){console.error("Error marking notification as read:",e)}};return(0,a.jsx)("div",{className:"fixed inset-0 z-50 flex items-start justify-end bg-black/50 md:items-center md:justify-center",onClick:t,children:(0,a.jsxs)("div",{className:"h-full w-full max-w-md overflow-auto bg-background p-4 shadow-lg md:h-auto md:max-h-[80vh] md:rounded-lg",onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between border-b pb-4",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold",children:"Th\xf4ng b\xe1o"}),(0,a.jsxs)(g.$,{variant:"ghost",size:"icon",onClick:t,children:[(0,a.jsx)(A.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Đ\xf3ng"})]})]}),(0,a.jsxs)("div",{className:"my-4 flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(_.S,{id:"unread-only",checked:s,onCheckedChange:e=>n(!!e)}),(0,a.jsx)(z.J,{htmlFor:"unread-only",children:"Chỉ hiển thị chưa đọc"})]}),(0,a.jsxs)(S.l6,{value:r,onValueChange:l,children:[(0,a.jsx)(S.bq,{className:"w-full md:w-[180px]",children:(0,a.jsx)(S.yv,{placeholder:"Lọc theo thời gian"})}),(0,a.jsxs)(S.gC,{children:[(0,a.jsx)(S.eb,{value:"all",children:"Tất cả"}),(0,a.jsx)(S.eb,{value:"today",children:"H\xf4m nay"}),(0,a.jsx)(S.eb,{value:"week",children:"7 ng\xe0y qua"}),(0,a.jsx)(S.eb,{value:"month",children:"Th\xe1ng n\xe0y"})]})]})]}),(0,a.jsx)("div",{className:"space-y-2",children:h?(0,a.jsx)("p",{className:"py-4 text-center text-muted-foreground",children:"Đang tải th\xf4ng b\xe1o..."}):x?(0,a.jsx)("p",{className:"py-4 text-center text-destructive",children:x}):f.length>0?f.map(e=>(0,a.jsxs)("div",{className:(0,p.cn)("rounded-lg border p-3 transition-colors hover:bg-muted/50",!e.read&&"border-l-4 border-l-primary"),children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("h3",{className:"font-medium",children:e.title}),(0,a.jsx)("span",{className:"text-xs text-muted-foreground",children:e.time})]}),(0,a.jsx)("p",{className:"mt-1 text-sm text-muted-foreground",children:L(e.content,40)}),(0,a.jsx)("div",{className:"mt-2 flex justify-end",children:(0,a.jsx)(g.$,{variant:"outline",size:"sm",onClick:()=>j(e),children:"Xem chi tiết"})})]},e.id)):(0,a.jsx)("p",{className:"py-4 text-center text-muted-foreground",children:"Kh\xf4ng c\xf3 th\xf4ng b\xe1o n\xe0o"})}),(0,a.jsx)(R.lG,{open:!!i,onOpenChange:e=>!e&&d(null),children:(0,a.jsxs)(R.Cf,{className:"sm:max-w-md max-h-[80vh] overflow-hidden flex flex-col",children:[(0,a.jsx)(R.c7,{children:(0,a.jsx)(R.L3,{children:null==i?void 0:i.title})}),(0,a.jsxs)("div",{className:"space-y-4 overflow-y-auto pr-1 flex-grow",children:[(0,a.jsx)("p",{className:"break-words",children:null==i?void 0:i.fullContent}),(0,a.jsx)("div",{className:"flex justify-between items-center text-sm text-muted-foreground",children:(0,a.jsx)("span",{children:null==i?void 0:i.time})})]}),(0,a.jsx)("div",{className:"mt-4 flex justify-end pt-2 border-t",children:(0,a.jsx)(R.HM,{asChild:!0,children:(0,a.jsx)(g.$,{children:"Đ\xf3ng"})})})]})})]})})}var T=s(9663);function V(){let{toggle:e}=(0,j.c)(),[t,s]=(0,v.useState)(!1);return(0,a.jsxs)("header",{className:"sticky top-0 z-30 flex h-16 items-center gap-4 border-b bg-background px-4 md:px-6",children:[(0,a.jsxs)(g.$,{variant:"ghost",size:"icon",className:"md:hidden",onClick:e,children:[(0,a.jsx)(b.A,{className:"h-5 w-5"}),(0,a.jsx)("span",{className:"sr-only",children:"Toggle Menu"})]}),(0,a.jsxs)("div",{className:"ml-auto flex items-center gap-4",children:[(0,a.jsxs)(g.$,{variant:"ghost",size:"icon",onClick:()=>s(!t),className:"relative",children:[(0,a.jsx)(x.A,{className:"h-5 w-5"}),(0,a.jsx)("span",{className:"absolute top-1 right-1 h-2 w-2 rounded-full bg-red-500"}),(0,a.jsx)("span",{className:"sr-only",children:"Notifications"})]}),(0,a.jsxs)(C.rI,{children:[(0,a.jsx)(C.ty,{asChild:!0,children:(0,a.jsxs)(g.$,{variant:"ghost",size:"icon",children:[(0,a.jsx)(w.A,{className:"h-5 w-5"}),(0,a.jsx)("span",{className:"sr-only",children:"Language"})]})}),(0,a.jsxs)(C.SQ,{align:"end",children:[(0,a.jsx)(C._2,{children:"Tiếng Việt"}),(0,a.jsx)(C._2,{children:"English"})]})]}),(0,a.jsxs)(C.rI,{children:[(0,a.jsx)(C.ty,{asChild:!0,children:(0,a.jsx)(g.$,{variant:"ghost",className:"relative h-8 w-8 rounded-full",children:(0,a.jsxs)(T.eu,{className:"h-8 w-8",children:[(0,a.jsx)(T.BK,{src:"/placeholder.svg?height=32&width=32",alt:"Avatar"}),(0,a.jsx)(T.q5,{children:"ST"})]})})}),(0,a.jsxs)(C.SQ,{align:"end",children:[(0,a.jsx)(C.lp,{children:"T\xe0i khoản"}),(0,a.jsx)(C.mB,{}),(0,a.jsxs)(C._2,{children:[(0,a.jsx)(k.A,{className:"mr-2 h-4 w-4"}),(0,a.jsx)("span",{children:"Hồ sơ"})]}),(0,a.jsx)(C._2,{children:"C\xe0i đặt"}),(0,a.jsx)(C.mB,{}),(0,a.jsx)(C._2,{children:"Đăng xuất"})]})]})]}),t&&(0,a.jsx)(P,{onClose:()=>s(!1)})]})}function $(e){let{children:t}=e,{isOpen:s}=(0,j.c)();return(0,a.jsxs)("div",{className:"flex h-screen overflow-hidden",children:[(0,a.jsx)(N,{}),(0,a.jsxs)("div",{className:(0,p.cn)("flex flex-col flex-1 overflow-hidden transition-all duration-300",s?"md:ml-64":"md:ml-20"),children:[(0,a.jsx)(V,{}),(0,a.jsx)("main",{className:"flex-1 overflow-y-auto p-4 md:p-6 bg-gray-50 dark:bg-gray-900",children:t})]})]})}},6053:(e,t,s)=>{"use strict";s.d(t,{SidebarProvider:()=>l,c:()=>i});var a=s(5155),n=s(2115);let r=n.createContext(void 0);function l(e){let{children:t}=e,[s,l]=n.useState(!0),i=n.useCallback(()=>{l(e=>!e)},[]);return(0,a.jsx)(r.Provider,{value:{isOpen:s,toggle:i},children:t})}function i(){let e=n.useContext(r);if(void 0===e)throw Error("useSidebar must be used within a SidebarProvider");return e}},7133:(e,t,s)=>{"use strict";s.d(t,{SQ:()=>m,_2:()=>x,lp:()=>u,mB:()=>f,rI:()=>o,ty:()=>h});var a=s(5155),n=s(2115),r=s(8698),l=s(3052),i=s(5196),d=s(9428),c=s(3999);let o=r.bL,h=r.l9;r.YJ,r.ZL,r.Pb,r.z6,n.forwardRef((e,t)=>{let{className:s,inset:n,children:i,...d}=e;return(0,a.jsxs)(r.ZP,{ref:t,className:(0,c.cn)("flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",n&&"pl-8",s),...d,children:[i,(0,a.jsx)(l.A,{className:"ml-auto"})]})}).displayName=r.ZP.displayName,n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)(r.G5,{ref:t,className:(0,c.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...n})}).displayName=r.G5.displayName;let m=n.forwardRef((e,t)=>{let{className:s,sideOffset:n=4,...l}=e;return(0,a.jsx)(r.ZL,{children:(0,a.jsx)(r.UC,{ref:t,sideOffset:n,className:(0,c.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...l})})});m.displayName=r.UC.displayName;let x=n.forwardRef((e,t)=>{let{className:s,inset:n,...l}=e;return(0,a.jsx)(r.q7,{ref:t,className:(0,c.cn)("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",n&&"pl-8",s),...l})});x.displayName=r.q7.displayName,n.forwardRef((e,t)=>{let{className:s,children:n,checked:l,...d}=e;return(0,a.jsxs)(r.H_,{ref:t,className:(0,c.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),checked:l,...d,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(r.VF,{children:(0,a.jsx)(i.A,{className:"h-4 w-4"})})}),n]})}).displayName=r.H_.displayName,n.forwardRef((e,t)=>{let{className:s,children:n,...l}=e;return(0,a.jsxs)(r.hN,{ref:t,className:(0,c.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...l,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(r.VF,{children:(0,a.jsx)(d.A,{className:"h-2 w-2 fill-current"})})}),n]})}).displayName=r.hN.displayName;let u=n.forwardRef((e,t)=>{let{className:s,inset:n,...l}=e;return(0,a.jsx)(r.JU,{ref:t,className:(0,c.cn)("px-2 py-1.5 text-sm font-semibold",n&&"pl-8",s),...l})});u.displayName=r.JU.displayName;let f=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)(r.wv,{ref:t,className:(0,c.cn)("-mx-1 my-1 h-px bg-muted",s),...n})});f.displayName=r.wv.displayName},9361:(e,t,s)=>{Promise.resolve().then(s.bind(s,3674))},9663:(e,t,s)=>{"use strict";s.d(t,{BK:()=>d,eu:()=>i,q5:()=>c});var a=s(5155),n=s(2115),r=s(5977),l=s(3999);let i=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)(r.bL,{ref:t,className:(0,l.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",s),...n})});i.displayName=r.bL.displayName;let d=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)(r._V,{ref:t,className:(0,l.cn)("aspect-square h-full w-full",s),...n})});d.displayName=r._V.displayName;let c=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)(r.H4,{ref:t,className:(0,l.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",s),...n})});c.displayName=r.H4.displayName}},e=>{var t=t=>e(e.s=t);e.O(0,[543,692,62,33,918,747,81,441,684,358],()=>t(9361)),_N_E=e.O()}]);